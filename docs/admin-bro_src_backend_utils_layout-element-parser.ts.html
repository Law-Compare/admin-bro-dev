

<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5L24P7Z');</script><!-- End Google Tag Manager -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AdminBro - Auto-generated admin panel for node.js with react admin-bro/src/backend/utils/layout-element-parser.ts</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
    <link rel="stylesheet" type="text/css" href="fonts.css"/>
  
  
    
      <meta property="og:image" content="https://adminbro.com/splash/admin-bro.png" />
    
  
    
      <meta property="og:title" content="An Auto-generated Admin Panel for your Node.js Application" />
    
  
    
      <meta property="og:description" content="You, as a developer, provide database models, and AdminBro generates ReactJS UI which allows you (or other trusted users) to manage content." />
    
  
    
  
    
  
    
  
</head>



<body class="layout">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
             
                <a class="image" href="index.html">
                    <img src="images/logo-reg.svg" alt="logo">
                </a>
            
            
        </div>
        <div class="menu">
             
                <div class="top-buttons">
                    
                        <a  href="https://admin-bro-example-app-staging.herokuapp.com/admin"
                            target="_blank"
                            class="button is-primary is-outlined"
                        ?>
                            Demo
                        </a>
                    
                        <a  href="/tutorial-installation-instructions.html"
                            target=""
                            class="button is-primary is-outlined"
                        ?>
                            Get Started
                        </a>
                    
                        <a  href="https://join.slack.com/t/adminbro/shared_invite/zt-djsqxxpz-_YCS8UMtQ9Ade6DPuLR7Zw"
                            target=""
                            class="button is-primary"
                        ?>
                            <i class="fab fa-slack-hash fa-lg"></i> Join the community
                        </a>
                    
                </div>
                
            <div class="navigation">
                
                <div class="dropdown is-hoverable is-right">
                    <a class="dropdown-trigger link">
                        Tutorials
                        <i class="fas fa-chevron-down fa-xs"></i>
                    </a>
                    <div class="dropdown-menu">
                        <div class="dropdown-content">
                        
                            <a class="dropdown-item" href="tutorial-installation-instructions.html">
                                01. Installation instructions
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-passing-resources.html">
                                02. Adding resources
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-customizing-resources.html">
                                03. Customize resources
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-actions.html">
                                04. Customize actions
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-writing-react-components.html">
                                05. Writing your own Components
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-features.html">
                                06. Using AdminBro features
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-custom-dashboard.html">
                                07. Customize dashboard
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-rbac.html">
                                08. Role-Based Access Control
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-i18n.html">
                                09. Internationalization (i18n)
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-cms.html">
                                11. Content Management System
                            </a>
                        
                        </div>
                    </div>
                </div>
                
                <a
                    href="docs.html"
                    class="link"
                >
                    API
                </a>
                
                    
                        <a
                            href="section-design-system.html"
                            class="link"
                        >
                            Design System
                        </a>
                    
                        <a
                            href="section-modules.html"
                            class="link"
                        >
                            Modules
                        </a>
                    
                
                 
                    
                        <a
                            class="link user-link no-hover"
                            href="https://github.com/SoftwareBrothers/admin-bro"
                        >
                            <i class="fab fa-github fa-3x"></i>
                        </a>
                    
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="Search docs..." class="input">
                </div>
            
            <nav>
                
                    
                        <h2><a href="docs.html">Documentation</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="AdminBro.html">AdminBro</a></li><li><a href="ApiClient.html">ApiClient</a></li><li><a href="ApiController.html">ApiController</a></li><li><a href="ViewHelpers.html">ViewHelpers</a></li></ul><h3>Interfaces</h3><ul><li><a href="Action.html">Action</a></li><li><a href="AdminBroOptions.html">AdminBroOptions</a></li><li><a href="PropertyOptions.html">PropertyOptions</a></li><li><a href="ResourceOptions.html">ResourceOptions</a></li><li><a href="TranslateFunctions.html">TranslateFunctions</a></li></ul><h3>Interfaces / Frontend</h3><ul><li><a href="ActionJSON.html">ActionJSON</a></li><li><a href="PageJSON.html">PageJSON</a></li><li><a href="PropertyJSON.html">PropertyJSON</a></li><li><a href="RecordJSON.html">RecordJSON</a></li><li><a href="ResourceJSON.html">ResourceJSON</a></li></ul><h3>Components / Application</h3><ul><li><a href="ActionButton.html">ActionButton</a></li><li><a href="ActionHeader.html">ActionHeader</a></li><li><a href="BaseActionComponent.html">BaseActionComponent</a></li><li><a href="BasePropertyComponent.html">BasePropertyComponent</a></li><li><a href="DrawerPortal.html">DrawerPortal</a></li><li><a href="RecordsTableHeader.html">RecordsTableHeader</a></li><li><a href="SidebarResourceSection.html">SidebarResourceSection</a></li></ul><h3>Components / Hooks</h3><ul><li><a href="useCurrentAdmin.html">useCurrentAdmin</a></li><li><a href="useNotice.html">useNotice</a></li><li><a href="useRecord.html">useRecord</a></li><li><a href="useTranslation.html">useTranslation</a></li></ul><h3>Components / HOC</h3><ul><li><a href="withNotice.html">withNotice</a></li></ul><h3>Global</h3><ul><li><a href="global.html#buildFeature">buildFeature</a></li><li><a href="global.html#mergeResourceOptions">mergeResourceOptions</a></li></ul></div><div class="category"><h2>Base</h2><h3>Classes</h3><ul><li><a href="BaseDatabase.html">BaseDatabase</a></li><li><a href="BaseProperty.html">BaseProperty</a></li><li><a href="BaseRecord.html">BaseRecord</a></li><li><a href="BaseResource.html">BaseResource</a></li></ul></div><div class="category"><h2>Decorators</h2><h3>Classes</h3><ul><li><a href="ActionDecorator.html">ActionDecorator</a></li><li><a href="PropertyDecorator.html">PropertyDecorator</a></li><li><a href="ResourceDecorator.html">ResourceDecorator</a></li></ul></div><div class="category"><h2>Errors</h2><h3>Classes</h3><ul><li><a href="ConfigurationError.html">ConfigurationError</a></li><li><a href="ForbiddenError.html">ForbiddenError</a></li><li><a href="NotFoundError.html">NotFoundError</a></li><li><a href="NotImplementedError.html">NotImplementedError</a></li><li><a href="ValidationError.html">ValidationError</a></li></ul></div>
                    
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>admin-bro/src/backend/utils/layout-element-parser.ts</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* eslint-disable max-len */
import { BoxProps, HeaderProps, TextProps, BadgeProps, ButtonProps, LinkProps, LabelProps, IconProps } from '@admin-bro/design-system'
import { PropsWithChildren } from 'react'
import { CurrentAdmin } from '../../current-admin.interface'

export type LayoutElement =
  string |
  Array&lt;string> |
  Array&lt;LayoutElement> |
 [string, PropsWithChildren&lt;BoxProps>] |
 [PropsWithChildren&lt;BoxProps>, Array&lt;LayoutElement>] |
 ['@Header', PropsWithChildren&lt;HeaderProps>] |
 ['@H1', PropsWithChildren&lt;HeaderProps>] |
 ['@H2', PropsWithChildren&lt;HeaderProps>] |
 ['@H3', PropsWithChildren&lt;HeaderProps>] |
 ['@H4', PropsWithChildren&lt;HeaderProps>] |
 ['@H5', PropsWithChildren&lt;HeaderProps>] |
 ['@Text', PropsWithChildren&lt;TextProps>] |
 ['@Badge', PropsWithChildren&lt;BadgeProps>] |
 ['@Button', PropsWithChildren&lt;ButtonProps>] |
 ['@Link', PropsWithChildren&lt;LinkProps>] |
 ['@Label', PropsWithChildren&lt;LabelProps>] |
 ['@Icon', PropsWithChildren&lt;IconProps>] |
 [string, PropsWithChildren&lt;any>]

/**
 * Function returning Array&lt;LayoutElement> used by {@link Action#layout}
 *
 * @return  {Array&lt;LayoutElement>}
 * @memberof Action
 * @alias LayoutElementFunction
 */
export type LayoutElementFunction = (currentAdmin?: CurrentAdmin) => Array&lt;LayoutElement>

/**
 * It is generated from {@link Array&lt;LayoutElement>} passed in {@link Action#layout}
 *
 * @alias ParsedLayoutElement
 * @memberof ActionJSON
 */
export type ParsedLayoutElement = {
  /** List of paths to properties which should be rendered by given element */
  properties: Array&lt;string>;
  /** props passed to React component which wraps elements */
  props: PropsWithChildren&lt;any>;
  /** Nested layout elements */
  layoutElements: Array&lt;ParsedLayoutElement>;
  /** Component which should be used as a wrapper */
  component: string;
}

const isProp = (element): boolean => !!element
  &amp;&amp; typeof element === 'object'
  &amp;&amp; !Array.isArray(element)

const isComponentTag = (layoutElement: LayoutElement): boolean => (
  Array.isArray(layoutElement)
    &amp;&amp; typeof layoutElement[0] === 'string'
    &amp;&amp; layoutElement[0].startsWith('@')
    &amp;&amp; isProp(layoutElement[1])
)

const hasOnlyStringsProperties = function (
  layoutElement: LayoutElement,
): layoutElement is [string] {
  return Array.isArray(layoutElement)
    &amp;&amp; layoutElement.length > 0
    &amp;&amp; !isComponentTag(layoutElement)
    &amp;&amp; !(layoutElement as Array&lt;any>).find(el => (typeof el !== 'string'))
}

const hasArrayOfLayoutElements = function (
  layoutElement: LayoutElement,
): layoutElement is [LayoutElement] {
  return Array.isArray(layoutElement)
    &amp;&amp; layoutElement.length > 0
    &amp;&amp; !(layoutElement as Array&lt;any>).find(element => !Array.isArray(element))
}

const hasFirstStringProperty = function (layoutElement: LayoutElement): boolean {
  return Array.isArray(layoutElement)
    &amp;&amp; typeof layoutElement[0] === 'string'
    &amp;&amp; !isComponentTag(layoutElement)
}

const getPropertyNames = (layoutElement: LayoutElement): Array&lt;string> => {
  if (typeof layoutElement === 'string') { return [layoutElement] }

  if (hasOnlyStringsProperties(layoutElement)) {
    return layoutElement
  }
  if (hasFirstStringProperty(layoutElement)) {
    return [layoutElement[0]] as Array&lt;string>
  }
  return []
}

const getInnerLayoutElements = (layoutElement: LayoutElement): Array&lt;LayoutElement> => {
  // only cases like [{}, layoutElement] (whatever follows props)
  if (Array.isArray(layoutElement)
    &amp;&amp; isProp(layoutElement[0])) {
    return layoutElement[1] as Array&lt;LayoutElement>
  }
  if (hasArrayOfLayoutElements(layoutElement)) {
    return layoutElement
  }
  return []
}

const getComponent = (layoutElement: LayoutElement): string => {
  if (isComponentTag(layoutElement)) {
    return (layoutElement[0] as string).slice(1)
  }
  return 'Box'
}

const getProps = (layoutElement: LayoutElement): BoxProps => {
  if (Array.isArray(layoutElement) &amp;&amp; layoutElement.length) {
    const boxProps = (layoutElement as Array&lt;any>).find(isProp)
    return boxProps as unknown as BoxProps || {}
  }
  return {}
}

const layoutElementParser = (layoutElement: LayoutElement): ParsedLayoutElement => {
  const props = getProps(layoutElement)
  const innerLayoutElements = getInnerLayoutElements(layoutElement)
  const properties = getPropertyNames(layoutElement)
  const component = getComponent(layoutElement)

  return {
    props,
    layoutElements: innerLayoutElements.map(el => layoutElementParser(el)),
    properties,
    component,
  }
}

export default layoutElementParser


/**
 * {@link LayoutElement} is used to change the default layout of edit, show and new {@link Action actions}.
 * You define the layout as an {@link Array&lt;LayoutElement>} and AdminBro renders it with React components.
 *
 * You don't have to know React to create usable Layout for you actions but be sure
 * to take a look at the possible **Props** which can be used to style the components.
 * The most often used props are {@link BoxProps}, because {@link Box} is the default wrapper.
 *
 * ### Available values for a {@link LayoutElement} type
 *
 * To {@link Action#layout } you have to pass an {@link Array&lt;LayoutElement>}. Where each
 * {@link LayoutElement} could have a different type defining its position and purpose.
 *
 * ### Type definition
 *
 * Those are available types for {@link LayoutElement}
 *
 * | Type    | Purpose | Example |
 * |---------------|--------------------------------------------------------------|------------------|
 * | string        | It will be changed to the property in vertical layout        | `layout: ['name']` |
 * | {@link Array&lt;string>} |  It will be changed to the properties in vertical layout     | `layout: [['name', 'surname']]` |
 * | [string, {@link BoxProps}] | property wrapped by {@link Box} component with {@link BoxProps} | `layout: [['name', {width: 1/2}]]` |
 * | [{@link BoxProps}, {@link Array&lt;LayoutElement>}] | Creates a Box and nest all the child LayoutElements inside. | `layout: [[{width: 1/2}, ['name', 'surname']]]` |
 * | {@link Array&lt;LayoutElement>} | For grouping LayoutElements inside a wrapper          | `layout: [['name', {mt: 'xl'}], ['surname', , {ml: 'xl'}]]` |
 * | [@ComponentName, PropsWithChildren&lt;ComponentProps>] | if you precede first item with "@" it will create component of this name | `layout: [['@Header', {children: 'User Data'}]]` |
 *
 * ### Examples
 *
 * Let say you have following properties in your database: `companyName`, `email`, `address` and `companySize`
 *
 * #### 1. The simplest horizontal layout:
 *
 * ```
 * const layout = [
 *  'companyName',
 *  'email',
 *  'address',
 *  'companySize',
 * ]
 * ```
 *
 * generates:
 *
 * &lt;img src='./images/layout1.png' style="margin-bottom: 20px">
 *
 * #### 2. Now Wrap everything with a {@link Box} of `2/3` max width and horizontal margin (mx) set to auto. This will center all inputs
 *
 * ```
 * const layout = [
 *   [{ width: 2 / 3, mx: 'auto' }, [
 *     'companyName',
 *     'email',
 *     'address',
 *     'companySize',
 *   ]],
 * ]
 * ```
 *
 * generates:
 *
 * &lt;img src='./images/layout2.png'>
 *
 * > Hint: you can also pass an array to `width` to define how it will behave in a different responsive breakpoints.
 *
 * #### 3. Add headers between sections
 *
 * ```
 * const layout = [
 *   [{ width: 2 / 3, mx: 'auto' }, [
 *     ['@H3', { children: 'Company data' }],
 *     'companyName',
 *     'companySize',
 *     ['@H3', { children: 'Contact Info' }],
 *     'email',
 *     'address',
 *   ]],
 * ]
 * ```
 *
 * generates:
 *
 * &lt;img src='./images/layout3.png' style="margin-bottom: 20px" >
 *
 * > To inject content inside the given Component pass children props to it.
 *
 * #### 4. Make email and address 50% width
 *
 * We will wrap them with a {@link Box} (default component) which is a flex.
 * Then we will have to wrap also each of them with extra box to define paddings.
 *
 * I will also align to left top section that by removing `{ mx: auto }` and changing width to `1 / 2`.
 *
 * ```
 * const layout = [{ width: 1 / 2 }, [
 *     ['@H3', { children: 'Company data' }],
 *     'companyName',
 *     'companySize',
 *   ]],
 *   [
 *     ['@H3', { children: 'Contact Info' }],
 *     [{ flexDirection: 'row', flex: true }, [
 *       ['email', { pr: 'default', flexGrow: 1 }],
 *       ['address', { flexGrow: 1 }],
 *     ]],
 *   ],
 * ]
 * ```
 *
 * generates:
 *
 * &lt;img src='./images/layout4.png' style="margin-bottom: 20px">
 *
 * #### 5. Lastly, take a look at the example with a function instead of {@link LayoutElement}.
 *
 * ```
 * const layout = currentAdmin => ([
 *  ['@MessageBox', {
 *    message: `Welcome ${currentAdmin &amp;&amp; currentAdmin.email}`,
 *    children: 'On this page yo can do whatever you like',
 *    variant: 'info',
 *    mb: 'xxl',
 *  }],
 *  [
 *    'companyName',
 *    'companySize',
 *    'email',
 *    'address',
 *  ],
 * ])
 * ```
 *
 * Generates following **Show** page:
 *
 * &lt;img src='./images/layout5.png'>
 *
 * @name LayoutElement
 * @typedef {String | Array} LayoutElement
 * @memberof Action
 * @alias LayoutElement
 */
</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>

</body>
</html>
